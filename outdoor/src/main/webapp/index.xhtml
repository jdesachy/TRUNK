<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">
<f:view locale="fr">
	<h:head>
		<title><h:outputText value="#{msg['welcome.topTitle']}" /></title>
		<h:outputStylesheet library="css" name="styles.css" />
		<script type="text/javascript" src="http://api.ign.fr/geoportail/api/js/latest/Geoportal.js"><!-- --></script>
	</h:head>
	<h:body>

		<div id="welcomPage" class="page">
			<ui:include src="/menu.xhtml" />

			Bienvenue sur mon site !

			 <div id="viewerDiv"></div>
    	
    
 		<script type="text/javascript"><!--//--><![CDATA[//><!--
    var iv=null;
	window.onload= function()
		{
        iv = Geoportal.load(
		'viewerDiv',
		['#{ignKey.value}'],
		{lat:47, lon:2.8},5,
			//options
			{
			// viewerClass:Geoportal.Viewer.Default, //pour mettre la boite à outil standard (zoom, coordonnées, gestion des couches de données..)
			
			layers:['GEOGRAPHICALGRIDSYSTEMS.MAPS','ORTHOIMAGERY.ORTHOPHOTOS'],
			
			layersOptions:{'GEOGRAPHICALGRIDSYSTEMS.MAPS':{visibility:true,opacity:1,  minZoomLevel:1,maxZoomLevel:18},
                                'ORTHOIMAGERY.ORTHOPHOTOS':{visibility:false,opacity:1, minZoomLevel:1, maxZoomLevel:18}},
			onView: function() {
						
						viewer=this.getViewer();
						
						/* style de la trace */
						var styleTrace = new OpenLayers.StyleMap({
						"default": new OpenLayers.Style({
         
						strokeColor: '#ff0000',
						strokeOpacity: 0.8,
						strokeWidth:5
		
						}),
						"select": new OpenLayers.Style({
						strokeColor: '#FF0000',
						})
						});
   
						/* ajout du fichier gpx   */
						gpxLayer = viewer.getMap().addLayer(
						"GPX",
						"trace",
						"http://jerome.desachy.free.fr/exercise-2014-2-15.gpx",{
							visibility: true,
							opacity:0.8,
							styleMap: styleTrace,
							eventListeners:{
								'loadend':function(){
									if (this.maxExtent) {
										this.map.zoomToExtent(this.maxExtent);
										this.setVisibility(true);
										}
									}
								}
							}
						);


  
                    },
					overlays:{},
								
			} //fin des options
			
			
        );
    };
    //--><!]]></script>
		</div>
	</h:body>
</f:view>
</html>
